<div class="wrapper-index">

  <%= render "shared/side_navbar" %>
  <div class="demo">

    <div class="container index-container text-center">
      <div class="header-hi">
        <h1>Hi, Clara</h1>
        <% if @user_products.all.length > 0 && (@user_products.order(:peremption_date).first.peremption_date - Date.today).to_i < 1 %>
          <!-- <h3>Tu as <%#= @user_products.count %> produits dans ta cuisine</h3> -->
          <h4>Il semblerait que <%= @user_products.order(:peremption_date).first.product.name%> va bientôt périmer !</h4>
          <h5>Let's cook it !</h5>
        <% else %>
          <h4>What's in your fridge today ?</h4>
        <% end %>
      </div>


      <div class="row">
        <% @user_products.order(:peremption_date).each do |user_product| %>
          <div data-user-product-id="<%= user_product.id %>">
            <div class="col-xs-12 col-sm-8 col-sm-offset-2">
              <div class="card" data-date="<%= user_product.id %>">

                <div>
                  <h4><%= user_product.product.name.capitalize %></h4>
                  <p>Ajouté il y a <%= (Date.today - user_product.purchase_date).to_i %> jour(s)</p>
                </div>
                <div class="card-menu">
                  <%= link_to edit_user_product_path(user_product) do%>
                  <%= icon("fas", 'edit') %>
                  <% end  %>
                  <%= link_to user_product_path(user_product), method: :delete, remote: true do %>
                  <%= icon("fas", 'trash-alt') %>
                  <% end %>
                </div>
              </div>
            </div>


            <% if (user_product.peremption_date.nil?) %>
              <script>
                document.querySelector("[data-date='<%= user_product.id %>']").style.borderLeft = "6px solid black";
              </script>
            <% elsif (user_product.peremption_date - Date.today).to_i < 1 %>
              <script>
                document.querySelector("[data-date='<%= user_product.id %>']").style.borderLeft = "6px solid red";
              </script>
            <% elsif (user_product.peremption_date - Date.today).to_i  == 1 || (user_product.peremption_date - Date.today).to_i < 3 %>
              <script>
                document.querySelector("[data-date='<%= user_product.id %>']").style.borderLeft = "6px solid orange";
              </script>
            <% else %>
              <script>
                document.querySelector("[data-date='<%= user_product.id %>']").style.borderLeft = "6px solid green";
              </script>
            <% end %>

          </div>

        <% end %>
      </div>
    </div>
  </div>
</div>








